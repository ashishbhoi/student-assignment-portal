@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

<div class="container mx-auto px-4 py-8">
    <div class="text-center mb-12">
        <h1 class="text-4xl font-bold text-on-surface mb-4">Welcome to the Student Classwork Portal</h1>
        <p class="text-lg text-on-surface-variant">Please log in to access your dashboard or browse the public resources
            below.</p>
    </div>

    <div>
        <h2 class="text-3xl font-semibold text-on-surface mb-6">Public Resources</h2>
        @if (Model.PublicResources.Any())
        {
            var groupedResources = Model.PublicResources.GroupBy(r => r.Class).OrderBy(g => g.Key);

            <div class="space-y-8">
                @foreach (var classGroup in groupedResources)
                {
                    <div>
                        <h3 class="text-2xl font-bold text-secondary mb-4">Class @classGroup.Key</h3>
                        <div class="space-y-4">
                            @foreach (var resource in classGroup.OrderBy(r => r.Chapter))
                            {
                                <div class="bg-surface rounded-lg shadow-md p-6">
                                    <h4 class="text-xl font-semibold text-on-surface">
                                        Subject: @resource.AssignmentName</h4>
                                    <p class="text-md text-on-surface-variant mb-4">Chapter: @resource.Chapter</p>
                                    @if (resource.UserFiles.Any())
                                    {
                                        <ul class="list-disc list-inside space-y-2">
                                            @foreach (var file in resource.UserFiles)
                                            {
                                                <li>
                                                    <a asp-page="/Public/ViewResource" asp-route-fileId="@file.Id"
                                                       class="text-primary hover:underline">
                                                        @file.FileName
                                                    </a>
                                                </li>
                                            }
                                        </ul>
                                    }
                                    else
                                    {
                                        <p class="text-sm text-on-surface-variant">No files in this folder yet.</p>
                                    }
                                </div>
                            }
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <p class="text-center text-on-surface-variant">No public resources are available at this time.</p>
        }
    </div>
</div>
